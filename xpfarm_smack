--v0.9.1

local power = turtle.getFuelLevel() > 10

local fuel = {"coal", "charcoal", "lava"}

function isfuel(c)
    for d=1,#fuel do
        if string.find(c, fuel[d]) then
            print("this is fuel!")
            return true
        else
            print("not fuel!")
            return false
        end
    end
end

function dump()

--go through each slot
--if it is fuel, skip it and move to next slot
    for b=1,16 do
        turtle.select(b)
        for uu=1,#fuel do
            local item = turtle.getItemDetail(b)
            if item then
                if isfuel(item.name) then
                    print("item is ", item.name)
                    print("skipping slot ", b)
                    break
                else
                    print("dumping slot ", b)
                    turtle.dropDown()
                end
            end 
        end
    end
end

function trygas()
    for m=1,16 do
        turtle.select(m)
        if turtle.refuel(m) then
            print("refueled from ", m)
            return true
        end
    end
    return false
end

if power == false then
    print("low fuel, attempting refuel")
    trygas()
end

while power do

    if turtle.attack() == false then
        dump()
    end
    turtle.suck()

    power = turtle.getFuelLevel() > 10

    if power == false then
        print("low fuel, attempting refuel")
        trygas()
    end

end
